<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>decompiler: EmulateSnippet Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">decompiler
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classEmulateSnippet-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">EmulateSnippet Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classEmulate.html" title="A pcode-based emulator interface.">Emulate</a> a <em>snippet</em> of PcodeOps out of a functional context.  
 <a href="classEmulateSnippet.html#details">More...</a></p>

<p><code>#include &lt;emulateutil.hh&gt;</code></p>
<div class="dynheader">
Inheritance diagram for EmulateSnippet:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classEmulateSnippet.png" usemap="#EmulateSnippet_map" alt=""/>
  <map id="EmulateSnippet_map" name="EmulateSnippet_map">
<area href="classEmulate.html" title="A pcode-based emulator interface." alt="Emulate" shape="rect" coords="0,0,98,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af333890e0d9a94efbd3557070a829a44"><td class="memItemLeft" align="right" valign="top"><a id="af333890e0d9a94efbd3557070a829a44"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#af333890e0d9a94efbd3557070a829a44">~EmulateSnippet</a> (void)</td></tr>
<tr class="memdesc:af333890e0d9a94efbd3557070a829a44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:af333890e0d9a94efbd3557070a829a44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22a13101a25f73f33a9b10f20ebf018a"><td class="memItemLeft" align="right" valign="top"><a id="a22a13101a25f73f33a9b10f20ebf018a"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#a22a13101a25f73f33a9b10f20ebf018a">setExecuteAddress</a> (const <a class="el" href="classAddress.html">Address</a> &amp;addr)</td></tr>
<tr class="memdesc:a22a13101a25f73f33a9b10f20ebf018a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the address of the next instruction to emulate. <br /></td></tr>
<tr class="separator:a22a13101a25f73f33a9b10f20ebf018a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef11e510794c009453333e847acc38e9"><td class="memItemLeft" align="right" valign="top"><a id="aef11e510794c009453333e847acc38e9"></a>
virtual <a class="el" href="classAddress.html">Address</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#aef11e510794c009453333e847acc38e9">getExecuteAddress</a> (void) const</td></tr>
<tr class="memdesc:aef11e510794c009453333e847acc38e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the address of the current instruction being executed. <br /></td></tr>
<tr class="separator:aef11e510794c009453333e847acc38e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a243812d9450f7d70610e23924def533f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#a243812d9450f7d70610e23924def533f">resetMemory</a> (void)</td></tr>
<tr class="memdesc:a243812d9450f7d70610e23924def533f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the emulation snippet.  <a href="classEmulateSnippet.html#a243812d9450f7d70610e23924def533f">More...</a><br /></td></tr>
<tr class="separator:a243812d9450f7d70610e23924def533f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad45023c5e4a7170496ef8acc48835d32"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPcodeEmit.html">PcodeEmit</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#ad45023c5e4a7170496ef8acc48835d32">buildEmitter</a> (const vector&lt; <a class="el" href="classOpBehavior.html">OpBehavior</a> * &gt; &amp;inst, uintb uniqReserve)</td></tr>
<tr class="memdesc:ad45023c5e4a7170496ef8acc48835d32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provide the caller with an emitter for building the p-code snippet.  <a href="classEmulateSnippet.html#ad45023c5e4a7170496ef8acc48835d32">More...</a><br /></td></tr>
<tr class="separator:ad45023c5e4a7170496ef8acc48835d32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad83f137b630e90877b05ea13f8d1d1be"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#ad83f137b630e90877b05ea13f8d1d1be">checkForLegalCode</a> (void) const</td></tr>
<tr class="memdesc:ad83f137b630e90877b05ea13f8d1d1be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for p-code that is deemed illegal for a <em>snippet</em>.  <a href="classEmulateSnippet.html#ad83f137b630e90877b05ea13f8d1d1be">More...</a><br /></td></tr>
<tr class="separator:ad83f137b630e90877b05ea13f8d1d1be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace37ff31a80e1f296221195eeec4a4fb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#ace37ff31a80e1f296221195eeec4a4fb">setCurrentOp</a> (int4 i)</td></tr>
<tr class="memdesc:ace37ff31a80e1f296221195eeec4a4fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the current executing p-code op by index.  <a href="classEmulateSnippet.html#ace37ff31a80e1f296221195eeec4a4fb">More...</a><br /></td></tr>
<tr class="separator:ace37ff31a80e1f296221195eeec4a4fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc4c1bf018f8ab3c0cea77fa927f5968"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#abc4c1bf018f8ab3c0cea77fa927f5968">setVarnodeValue</a> (uintb offset, uintb val)</td></tr>
<tr class="memdesc:abc4c1bf018f8ab3c0cea77fa927f5968"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a temporary register value in the machine state.  <a href="classEmulateSnippet.html#abc4c1bf018f8ab3c0cea77fa927f5968">More...</a><br /></td></tr>
<tr class="separator:abc4c1bf018f8ab3c0cea77fa927f5968"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af19946de88e6ea7dbf396648640fdb97"><td class="memItemLeft" align="right" valign="top">uintb&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#af19946de88e6ea7dbf396648640fdb97">getVarnodeValue</a> (<a class="el" href="structVarnodeData.html">VarnodeData</a> *vn) const</td></tr>
<tr class="memdesc:af19946de88e6ea7dbf396648640fdb97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the value of a <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size.">Varnode</a> from the current machine state.  <a href="classEmulateSnippet.html#af19946de88e6ea7dbf396648640fdb97">More...</a><br /></td></tr>
<tr class="separator:af19946de88e6ea7dbf396648640fdb97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77a5c0e4b9085b84e2d487568f9aa484"><td class="memItemLeft" align="right" valign="top">uintb&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#a77a5c0e4b9085b84e2d487568f9aa484">getTempValue</a> (uintb offset) const</td></tr>
<tr class="memdesc:a77a5c0e4b9085b84e2d487568f9aa484"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve a temporary register value directly.  <a href="classEmulateSnippet.html#a77a5c0e4b9085b84e2d487568f9aa484">More...</a><br /></td></tr>
<tr class="separator:a77a5c0e4b9085b84e2d487568f9aa484"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classEmulate"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classEmulate')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classEmulate.html">Emulate</a></td></tr>
<tr class="memitem:a4858bc80cf7b078a592f9c8d3442450d inherit pub_methods_classEmulate"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulate.html#a4858bc80cf7b078a592f9c8d3442450d">setHalt</a> (bool val)</td></tr>
<tr class="memdesc:a4858bc80cf7b078a592f9c8d3442450d inherit pub_methods_classEmulate"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the <em>halt</em> state of the emulator.  <a href="classEmulate.html#a4858bc80cf7b078a592f9c8d3442450d">More...</a><br /></td></tr>
<tr class="separator:a4858bc80cf7b078a592f9c8d3442450d inherit pub_methods_classEmulate"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1f2882dd3554c18c60e817e80f3c4bc inherit pub_methods_classEmulate"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulate.html#ab1f2882dd3554c18c60e817e80f3c4bc">getHalt</a> (void) const</td></tr>
<tr class="memdesc:ab1f2882dd3554c18c60e817e80f3c4bc inherit pub_methods_classEmulate"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the <em>halt</em> state of the emulator.  <a href="classEmulate.html#ab1f2882dd3554c18c60e817e80f3c4bc">More...</a><br /></td></tr>
<tr class="separator:ab1f2882dd3554c18c60e817e80f3c4bc inherit pub_methods_classEmulate"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad37ba97a90d7cd5338a75afce3a21b9 inherit pub_methods_classEmulate"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulate.html#aad37ba97a90d7cd5338a75afce3a21b9">executeCurrentOp</a> (void)</td></tr>
<tr class="memdesc:aad37ba97a90d7cd5338a75afce3a21b9 inherit pub_methods_classEmulate"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do a single pcode op step.  <a href="classEmulate.html#aad37ba97a90d7cd5338a75afce3a21b9">More...</a><br /></td></tr>
<tr class="separator:aad37ba97a90d7cd5338a75afce3a21b9 inherit pub_methods_classEmulate"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a8143826681e065b6e04a38fb128188cb"><td class="memItemLeft" align="right" valign="top">uintb&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#a8143826681e065b6e04a38fb128188cb">getLoadImageValue</a> (<a class="el" href="classAddrSpace.html">AddrSpace</a> *spc, uintb offset, int4 sz) const</td></tr>
<tr class="memdesc:a8143826681e065b6e04a38fb128188cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pull a value from the load-image given a specific address.  <a href="classEmulateSnippet.html#a8143826681e065b6e04a38fb128188cb">More...</a><br /></td></tr>
<tr class="separator:a8143826681e065b6e04a38fb128188cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8109743cbfc62e47a294d16926c825b1"><td class="memItemLeft" align="right" valign="top"><a id="a8109743cbfc62e47a294d16926c825b1"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#a8109743cbfc62e47a294d16926c825b1">executeUnary</a> (void)</td></tr>
<tr class="memdesc:a8109743cbfc62e47a294d16926c825b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute a unary arithmetic/logical operation. <br /></td></tr>
<tr class="separator:a8109743cbfc62e47a294d16926c825b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af98797eb538d417acf1e2b06ccb63057"><td class="memItemLeft" align="right" valign="top"><a id="af98797eb538d417acf1e2b06ccb63057"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#af98797eb538d417acf1e2b06ccb63057">executeBinary</a> (void)</td></tr>
<tr class="memdesc:af98797eb538d417acf1e2b06ccb63057"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute a binary arithmetic/logical operation. <br /></td></tr>
<tr class="separator:af98797eb538d417acf1e2b06ccb63057"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adecc94a311f6ed0c1f3de055354f16b3"><td class="memItemLeft" align="right" valign="top"><a id="adecc94a311f6ed0c1f3de055354f16b3"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#adecc94a311f6ed0c1f3de055354f16b3">executeLoad</a> (void)</td></tr>
<tr class="memdesc:adecc94a311f6ed0c1f3de055354f16b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Standard behavior for a p-code LOAD. <br /></td></tr>
<tr class="separator:adecc94a311f6ed0c1f3de055354f16b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc352630cc11f4e2704e16287a48c3c2"><td class="memItemLeft" align="right" valign="top"><a id="adc352630cc11f4e2704e16287a48c3c2"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#adc352630cc11f4e2704e16287a48c3c2">executeStore</a> (void)</td></tr>
<tr class="memdesc:adc352630cc11f4e2704e16287a48c3c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Standard behavior for a p-code STORE. <br /></td></tr>
<tr class="separator:adc352630cc11f4e2704e16287a48c3c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a432015b441566c75b536685bd196f874"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#a432015b441566c75b536685bd196f874">executeBranch</a> (void)</td></tr>
<tr class="memdesc:a432015b441566c75b536685bd196f874"><td class="mdescLeft">&#160;</td><td class="mdescRight">Standard behavior for a BRANCH.  <a href="classEmulateSnippet.html#a432015b441566c75b536685bd196f874">More...</a><br /></td></tr>
<tr class="separator:a432015b441566c75b536685bd196f874"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6539d38f36a17f3bcf856a4a3b4d0895"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#a6539d38f36a17f3bcf856a4a3b4d0895">executeCbranch</a> (void)</td></tr>
<tr class="memdesc:a6539d38f36a17f3bcf856a4a3b4d0895"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the conditional of a CBRANCH is <b>true</b>.  <a href="classEmulateSnippet.html#a6539d38f36a17f3bcf856a4a3b4d0895">More...</a><br /></td></tr>
<tr class="separator:a6539d38f36a17f3bcf856a4a3b4d0895"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1911ba6015f2301f25e79ebbc695251f"><td class="memItemLeft" align="right" valign="top"><a id="a1911ba6015f2301f25e79ebbc695251f"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#a1911ba6015f2301f25e79ebbc695251f">executeBranchind</a> (void)</td></tr>
<tr class="memdesc:a1911ba6015f2301f25e79ebbc695251f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Standard behavior for a BRANCHIND. <br /></td></tr>
<tr class="separator:a1911ba6015f2301f25e79ebbc695251f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e2fe137ea8e36a0b69af2dc9efc74ab"><td class="memItemLeft" align="right" valign="top"><a id="a7e2fe137ea8e36a0b69af2dc9efc74ab"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#a7e2fe137ea8e36a0b69af2dc9efc74ab">executeCall</a> (void)</td></tr>
<tr class="memdesc:a7e2fe137ea8e36a0b69af2dc9efc74ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Standard behavior for a p-code CALL. <br /></td></tr>
<tr class="separator:a7e2fe137ea8e36a0b69af2dc9efc74ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac62814ea8e717e3d82e4c9507cdbabc1"><td class="memItemLeft" align="right" valign="top"><a id="ac62814ea8e717e3d82e4c9507cdbabc1"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#ac62814ea8e717e3d82e4c9507cdbabc1">executeCallind</a> (void)</td></tr>
<tr class="memdesc:ac62814ea8e717e3d82e4c9507cdbabc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Standard behavior for a CALLIND. <br /></td></tr>
<tr class="separator:ac62814ea8e717e3d82e4c9507cdbabc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48e46167f88023904fea64d21658618f"><td class="memItemLeft" align="right" valign="top"><a id="a48e46167f88023904fea64d21658618f"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#a48e46167f88023904fea64d21658618f">executeCallother</a> (void)</td></tr>
<tr class="memdesc:a48e46167f88023904fea64d21658618f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Standard behavior for a user-defined p-code op. <br /></td></tr>
<tr class="separator:a48e46167f88023904fea64d21658618f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc877fc5538723ebf35b2367231c6c79"><td class="memItemLeft" align="right" valign="top"><a id="acc877fc5538723ebf35b2367231c6c79"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#acc877fc5538723ebf35b2367231c6c79">executeMultiequal</a> (void)</td></tr>
<tr class="memdesc:acc877fc5538723ebf35b2367231c6c79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Standard behavior for a MULTIEQUAL (phi-node) <br /></td></tr>
<tr class="separator:acc877fc5538723ebf35b2367231c6c79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80f42ee91164952a9be1d14f26313e0d"><td class="memItemLeft" align="right" valign="top"><a id="a80f42ee91164952a9be1d14f26313e0d"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#a80f42ee91164952a9be1d14f26313e0d">executeIndirect</a> (void)</td></tr>
<tr class="memdesc:a80f42ee91164952a9be1d14f26313e0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Standard behavior for an INDIRECT op. <br /></td></tr>
<tr class="separator:a80f42ee91164952a9be1d14f26313e0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab212aab814e64abf367f7ca71694c9b"><td class="memItemLeft" align="right" valign="top"><a id="aab212aab814e64abf367f7ca71694c9b"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#aab212aab814e64abf367f7ca71694c9b">executeSegmentOp</a> (void)</td></tr>
<tr class="memdesc:aab212aab814e64abf367f7ca71694c9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Behavior for a SEGMENTOP. <br /></td></tr>
<tr class="separator:aab212aab814e64abf367f7ca71694c9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bde6160c97844190ed4d406fccc8cea"><td class="memItemLeft" align="right" valign="top"><a id="a6bde6160c97844190ed4d406fccc8cea"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#a6bde6160c97844190ed4d406fccc8cea">executeCpoolRef</a> (void)</td></tr>
<tr class="memdesc:a6bde6160c97844190ed4d406fccc8cea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Standard behavior for a CPOOLREF (constant pool reference) op. <br /></td></tr>
<tr class="separator:a6bde6160c97844190ed4d406fccc8cea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a522733bfee593de40dd2ced5f7618ba4"><td class="memItemLeft" align="right" valign="top"><a id="a522733bfee593de40dd2ced5f7618ba4"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#a522733bfee593de40dd2ced5f7618ba4">executeNew</a> (void)</td></tr>
<tr class="memdesc:a522733bfee593de40dd2ced5f7618ba4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Standard behavior for (low-level) NEW op. <br /></td></tr>
<tr class="separator:a522733bfee593de40dd2ced5f7618ba4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6daea3b10d9b4830441835aa5263137b"><td class="memItemLeft" align="right" valign="top"><a id="a6daea3b10d9b4830441835aa5263137b"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#a6daea3b10d9b4830441835aa5263137b">fallthruOp</a> (void)</td></tr>
<tr class="memdesc:a6daea3b10d9b4830441835aa5263137b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Standard p-code fall-thru semantics. <br /></td></tr>
<tr class="separator:a6daea3b10d9b4830441835aa5263137b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a263f579210ff77fc614843a244bd47d6"><td class="memItemLeft" align="right" valign="top"><a id="a263f579210ff77fc614843a244bd47d6"></a>
<a class="el" href="classArchitecture.html">Architecture</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#a263f579210ff77fc614843a244bd47d6">glb</a></td></tr>
<tr class="memdesc:a263f579210ff77fc614843a244bd47d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">The underlying <a class="el" href="classArchitecture.html" title="Manager for all the major decompiler subsystems.">Architecture</a> for the program being emulated. <br /></td></tr>
<tr class="separator:a263f579210ff77fc614843a244bd47d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad22c3300e30284d938e566b19af23f99"><td class="memItemLeft" align="right" valign="top"><a id="ad22c3300e30284d938e566b19af23f99"></a>
vector&lt; <a class="el" href="classPcodeOpRaw.html">PcodeOpRaw</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#ad22c3300e30284d938e566b19af23f99">opList</a></td></tr>
<tr class="memdesc:ad22c3300e30284d938e566b19af23f99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sequence of p-code ops to be executed. <br /></td></tr>
<tr class="separator:ad22c3300e30284d938e566b19af23f99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bbd6a2ebe45a38a6cd6ce9f01fd03fc"><td class="memItemLeft" align="right" valign="top"><a id="a0bbd6a2ebe45a38a6cd6ce9f01fd03fc"></a>
vector&lt; <a class="el" href="structVarnodeData.html">VarnodeData</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#a0bbd6a2ebe45a38a6cd6ce9f01fd03fc">varList</a></td></tr>
<tr class="memdesc:a0bbd6a2ebe45a38a6cd6ce9f01fd03fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Varnodes allocated for ops. <br /></td></tr>
<tr class="separator:a0bbd6a2ebe45a38a6cd6ce9f01fd03fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2f2e66401b029a1bd0f045328ff6fc5"><td class="memItemLeft" align="right" valign="top"><a id="ab2f2e66401b029a1bd0f045328ff6fc5"></a>
map&lt; uintb, uintb &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#ab2f2e66401b029a1bd0f045328ff6fc5">tempValues</a></td></tr>
<tr class="memdesc:ab2f2e66401b029a1bd0f045328ff6fc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Values stored in temporary registers. <br /></td></tr>
<tr class="separator:ab2f2e66401b029a1bd0f045328ff6fc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace07c5e58e1c94197290cf0a2ee86f27"><td class="memItemLeft" align="right" valign="top"><a id="ace07c5e58e1c94197290cf0a2ee86f27"></a>
<a class="el" href="classPcodeOpRaw.html">PcodeOpRaw</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#ace07c5e58e1c94197290cf0a2ee86f27">currentOp</a></td></tr>
<tr class="memdesc:ace07c5e58e1c94197290cf0a2ee86f27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current p-code op being executed. <br /></td></tr>
<tr class="separator:ace07c5e58e1c94197290cf0a2ee86f27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a790341abc60fd2f7b36fa9d144a3c64f"><td class="memItemLeft" align="right" valign="top"><a id="a790341abc60fd2f7b36fa9d144a3c64f"></a>
int4&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#a790341abc60fd2f7b36fa9d144a3c64f">pos</a></td></tr>
<tr class="memdesc:a790341abc60fd2f7b36fa9d144a3c64f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index of current p-code op being executed. <br /></td></tr>
<tr class="separator:a790341abc60fd2f7b36fa9d144a3c64f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classEmulate"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classEmulate')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classEmulate.html">Emulate</a></td></tr>
<tr class="memitem:a8811816cbc0eef9f4cdb856cfd496e94 inherit pro_attribs_classEmulate"><td class="memItemLeft" align="right" valign="top"><a id="a8811816cbc0eef9f4cdb856cfd496e94"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulate.html#a8811816cbc0eef9f4cdb856cfd496e94">emu_halted</a></td></tr>
<tr class="memdesc:a8811816cbc0eef9f4cdb856cfd496e94 inherit pro_attribs_classEmulate"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set to <b>true</b> if the emulator is halted. <br /></td></tr>
<tr class="separator:a8811816cbc0eef9f4cdb856cfd496e94 inherit pro_attribs_classEmulate"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e5d4f8c0ad5c62aa3e723440c5141ca inherit pro_attribs_classEmulate"><td class="memItemLeft" align="right" valign="top"><a id="a1e5d4f8c0ad5c62aa3e723440c5141ca"></a>
<a class="el" href="classOpBehavior.html">OpBehavior</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulate.html#a1e5d4f8c0ad5c62aa3e723440c5141ca">currentBehave</a></td></tr>
<tr class="memdesc:a1e5d4f8c0ad5c62aa3e723440c5141ca inherit pro_attribs_classEmulate"><td class="mdescLeft">&#160;</td><td class="mdescRight">Behavior of the next op to execute. <br /></td></tr>
<tr class="separator:a1e5d4f8c0ad5c62aa3e723440c5141ca inherit pro_attribs_classEmulate"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classEmulate.html" title="A pcode-based emulator interface.">Emulate</a> a <em>snippet</em> of PcodeOps out of a functional context. </p>
<p>Emulation is performed on a short sequence (<b>snippet</b>) of <a class="el" href="classPcodeOpRaw.html" title="A low-level representation of a single pcode operation.">PcodeOpRaw</a> objects. Control-flow emulation is limited to this snippet; BRANCH and CBRANCH operations can happen using p-code relative branching. Executing BRANCHIND, CALL, CALLIND, CALLOTHER, STORE, MULTIEQUAL, INDIRECT, SEGMENTOP, CPOOLOP, and NEW ops is treated as illegal and an exception is thrown. Expressions can only use temporary registers or read from the <a class="el" href="classLoadImage.html" title="An interface into a particular binary executable image.">LoadImage</a>.</p>
<p>The set of <a class="el" href="classPcodeOpRaw.html" title="A low-level representation of a single pcode operation.">PcodeOpRaw</a> objects in the snippet is provided by emitting p-code to the object returned by <a class="el" href="classEmulateSnippet.html#ad45023c5e4a7170496ef8acc48835d32" title="Provide the caller with an emitter for building the p-code snippet.">buildEmitter()</a>. This is designed for one-time initialization of this class, which can be repeatedly used by calling <a class="el" href="classEmulateSnippet.html#a243812d9450f7d70610e23924def533f" title="Reset the emulation snippet.">resetMemory()</a> between executions. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ad45023c5e4a7170496ef8acc48835d32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad45023c5e4a7170496ef8acc48835d32">&#9670;&nbsp;</a></span>buildEmitter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPcodeEmit.html">PcodeEmit</a> * EmulateSnippet::buildEmitter </td>
          <td>(</td>
          <td class="paramtype">const vector&lt; <a class="el" href="classOpBehavior.html">OpBehavior</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>inst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintb&#160;</td>
          <td class="paramname"><em>uniqReserve</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Provide the caller with an emitter for building the p-code snippet. </p>
<p>Any p-code produced by the <a class="el" href="classPcodeEmit.html" title="Abstract class for emitting pcode to an application.">PcodeEmit</a>, when triggered by the caller, becomes part of the <em>snippet</em> that will get emulated by <b>this</b>. The caller should free the <a class="el" href="classPcodeEmit.html" title="Abstract class for emitting pcode to an application.">PcodeEmit</a> object immediately after use. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inst</td><td>is the <em>opcode</em> to <em>behavior</em> map the emitter will use </td></tr>
    <tr><td class="paramname">uniqReserve</td><td>is the starting offset within the <em>unique</em> address space for any temporary registers </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the newly constructed emitter </dd></dl>

<p class="reference">References <a class="el" href="classEmulateSnippet.html#ad22c3300e30284d938e566b19af23f99">opList</a>, and <a class="el" href="classEmulateSnippet.html#a0bbd6a2ebe45a38a6cd6ce9f01fd03fc">varList</a>.</p>

<p class="reference">Referenced by <a class="el" href="classExecutablePcode.html#a2c0d61dc81f9ea72fe85e674208bf093">ExecutablePcode::build()</a>.</p>

</div>
</div>
<a id="ad83f137b630e90877b05ea13f8d1d1be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad83f137b630e90877b05ea13f8d1d1be">&#9670;&nbsp;</a></span>checkForLegalCode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool EmulateSnippet::checkForLegalCode </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check for p-code that is deemed illegal for a <em>snippet</em>. </p>
<p>This method facilitates enforcement of the formal rules for snippet code.</p><ul>
<li>Branches must use p-code relative addressing.</li>
<li>Snippets can only read/write from temporary registers</li>
<li>Snippets cannot use BRANCHIND, CALL, CALLIND, CALLOTHER, STORE, SEGMENTOP, CPOOLREF, NEW, MULTIEQUAL, or INDIRECT</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd><b>true</b> if the current snippet is legal </dd></dl>

<p class="reference">References <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a8e04ce6913869e8db2eaf101ae59ed9e">CPUI_BRANCH</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7ac9526d56fc1c9dc6dc1f98c05729281a">CPUI_BRANCHIND</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a50235a7bf50bada36dff73ff740c34d0">CPUI_CALL</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a500b63ecb17a75652c705bfab98bc8e5">CPUI_CALLIND</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a7a2b625788b1d23eda50975b6baf7efb">CPUI_CALLOTHER</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a5d4235f59c3d4320bae86e84f0cc9f62">CPUI_CPOOLREF</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7aa89e33b07a26ca7d26b54315e45c8424">CPUI_INDIRECT</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a108d223da48e77fa181637fc3e75d9e8">CPUI_MULTIEQUAL</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a980255c6f8e1cd7c7c7b035554292735">CPUI_NEW</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7ab67fab74923ce6c8be1c2254b9afb4f9">CPUI_SEGMENTOP</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a14ab8d826af51873faa33b33e2bbc5fb">CPUI_STORE</a>, <a class="el" href="classPcodeOpRaw.html#a450f1af7453d285458b9cc00d5562bc4">PcodeOpRaw::getInput()</a>, <a class="el" href="classPcodeOpRaw.html#a6c8a73aa191303dfb59ea23acf9edd42">PcodeOpRaw::getOpcode()</a>, <a class="el" href="classPcodeOpRaw.html#a74d17c5335e043ff228c1c5f5e97cd74">PcodeOpRaw::getOutput()</a>, <a class="el" href="classAddrSpace.html#ab548f4158529a29122d4d0a30d94ed98">AddrSpace::getType()</a>, <a class="el" href="space_8hh.html#a1a83535cca68b7ca3f25bfad70262231a3ae8eb421cb8d460bc939657402d970a">IPTR_CONSTANT</a>, <a class="el" href="space_8hh.html#a1a83535cca68b7ca3f25bfad70262231a1eef2cfc279c246cc7ea0387d8c0aa66">IPTR_INTERNAL</a>, <a class="el" href="space_8hh.html#a1a83535cca68b7ca3f25bfad70262231ac6a759a590195b56c099150c63cdd7b2">IPTR_PROCESSOR</a>, <a class="el" href="classPcodeOpRaw.html#a35819a340681743d4fb345b686ae5565">PcodeOpRaw::numInput()</a>, <a class="el" href="classEmulateSnippet.html#ad22c3300e30284d938e566b19af23f99">opList</a>, and <a class="el" href="structVarnodeData.html#a1a69a5187f7a6376c0c93c08962ea68d">VarnodeData::space</a>.</p>

<p class="reference">Referenced by <a class="el" href="classExecutablePcode.html#a2c0d61dc81f9ea72fe85e674208bf093">ExecutablePcode::build()</a>.</p>

</div>
</div>
<a id="a432015b441566c75b536685bd196f874"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a432015b441566c75b536685bd196f874">&#9670;&nbsp;</a></span>executeBranch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EmulateSnippet::executeBranch </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Standard behavior for a BRANCH. </p>
<p>This routine performs a standard p-code BRANCH operation on the memory state. This same routine is used for CBRANCH operations if the condition has evaluated to <b>true</b>. </p>

<p>Implements <a class="el" href="classEmulate.html#a145cee350a9273250a970c9387ecbd81">Emulate</a>.</p>

<p class="reference">References <a class="el" href="classEmulateSnippet.html#ace07c5e58e1c94197290cf0a2ee86f27">currentOp</a>, <a class="el" href="classEmulate.html#a8811816cbc0eef9f4cdb856cfd496e94">Emulate::emu_halted</a>, <a class="el" href="classPcodeOpRaw.html#a450f1af7453d285458b9cc00d5562bc4">PcodeOpRaw::getInput()</a>, <a class="el" href="classAddrSpace.html#ab548f4158529a29122d4d0a30d94ed98">AddrSpace::getType()</a>, <a class="el" href="space_8hh.html#a1a83535cca68b7ca3f25bfad70262231a3ae8eb421cb8d460bc939657402d970a">IPTR_CONSTANT</a>, <a class="el" href="structVarnodeData.html#a1a511384ee72e847b51423cc99c8233e">VarnodeData::offset</a>, <a class="el" href="classEmulateSnippet.html#ad22c3300e30284d938e566b19af23f99">opList</a>, <a class="el" href="classEmulateSnippet.html#a790341abc60fd2f7b36fa9d144a3c64f">pos</a>, <a class="el" href="classEmulateSnippet.html#ace37ff31a80e1f296221195eeec4a4fb">setCurrentOp()</a>, and <a class="el" href="structVarnodeData.html#a1a69a5187f7a6376c0c93c08962ea68d">VarnodeData::space</a>.</p>

</div>
</div>
<a id="a6539d38f36a17f3bcf856a4a3b4d0895"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6539d38f36a17f3bcf856a4a3b4d0895">&#9670;&nbsp;</a></span>executeCbranch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool EmulateSnippet::executeCbranch </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if the conditional of a CBRANCH is <b>true</b>. </p>
<p>This routine only checks if the condition for a p-code CBRANCH is true. It does <em>not</em> perform the actual branch. </p><dl class="section return"><dt>Returns</dt><dd>the boolean state indicated by the condition </dd></dl>

<p>Implements <a class="el" href="classEmulate.html#ac0dbab7129d69471d8400a75c0c7c1b5">Emulate</a>.</p>

<p class="reference">References <a class="el" href="classEmulateSnippet.html#ace07c5e58e1c94197290cf0a2ee86f27">currentOp</a>, <a class="el" href="classPcodeOpRaw.html#a450f1af7453d285458b9cc00d5562bc4">PcodeOpRaw::getInput()</a>, and <a class="el" href="classEmulateSnippet.html#af19946de88e6ea7dbf396648640fdb97">getVarnodeValue()</a>.</p>

</div>
</div>
<a id="a8143826681e065b6e04a38fb128188cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8143826681e065b6e04a38fb128188cb">&#9670;&nbsp;</a></span>getLoadImageValue()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uintb EmulateSnippet::getLoadImageValue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAddrSpace.html">AddrSpace</a> *&#160;</td>
          <td class="paramname"><em>spc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintb&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int4&#160;</td>
          <td class="paramname"><em>sz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pull a value from the load-image given a specific address. </p>
<p>A contiguous chunk of memory is pulled from the load-image and returned as a constant value, respecting the endianess of the address space. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spc</td><td>is the address space to pull the value from </td></tr>
    <tr><td class="paramname">offset</td><td>is the starting address offset (from within the space) to pull the value from </td></tr>
    <tr><td class="paramname">sz</td><td>is the number of bytes to pull from memory </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>indicated bytes arranged as a constant value </dd></dl>

<p class="reference">References <a class="el" href="address_8hh.html#aedcacdf1dd5af3b58d59d76b8011d0f1">byte_swap()</a>, <a class="el" href="address_8hh.html#aae7b27e228c11138200b27f02831fc00">calc_mask()</a>, <a class="el" href="classEmulateSnippet.html#a263f579210ff77fc614843a244bd47d6">glb</a>, <a class="el" href="classAddrSpace.html#af5683c0d7e42edec80b97bcb9fb3dc11">AddrSpace::isBigEndian()</a>, <a class="el" href="classArchitecture.html#a344b1348ed8f0bbe0d050e7038bb290d">Architecture::loader</a>, and <a class="el" href="classLoadImage.html#af00d3957284bf0b4721be0ada5ef4328">LoadImage::loadFill()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classEmulateSnippet.html#adecc94a311f6ed0c1f3de055354f16b3">executeLoad()</a>, and <a class="el" href="classEmulateSnippet.html#af19946de88e6ea7dbf396648640fdb97">getVarnodeValue()</a>.</p>

</div>
</div>
<a id="a77a5c0e4b9085b84e2d487568f9aa484"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77a5c0e4b9085b84e2d487568f9aa484">&#9670;&nbsp;</a></span>getTempValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uintb EmulateSnippet::getTempValue </td>
          <td>(</td>
          <td class="paramtype">uintb&#160;</td>
          <td class="paramname"><em>offset</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve a temporary register value directly. </p>
<p>This allows the user to obtain the final value of the snippet calculation, without having to have the <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size.">Varnode</a> object in hand. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">offset</td><td>is the offset of the temporary register to retrieve </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the calculated value or 0 if the register was never written </dd></dl>

<p class="reference">References <a class="el" href="classEmulateSnippet.html#ab2f2e66401b029a1bd0f045328ff6fc5">tempValues</a>.</p>

<p class="reference">Referenced by <a class="el" href="classExecutablePcode.html#a0ff39a9bb778d67df86b741a20739d75">ExecutablePcode::evaluate()</a>.</p>

</div>
</div>
<a id="af19946de88e6ea7dbf396648640fdb97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af19946de88e6ea7dbf396648640fdb97">&#9670;&nbsp;</a></span>getVarnodeValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uintb EmulateSnippet::getVarnodeValue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structVarnodeData.html">VarnodeData</a> *&#160;</td>
          <td class="paramname"><em>vn</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the value of a <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size.">Varnode</a> from the current machine state. </p>
<p>If the <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size.">Varnode</a> is a temporary registers, the storage offset is used to look up the value from the machine state cache. If the <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size.">Varnode</a> represents a RAM location, the value is pulled directly out of the load-image. If the value does not exist, a "Read before write" exception is thrown. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vn</td><td>is the <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size.">Varnode</a> to read </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the retrieved value </dd></dl>

<p class="reference">References <a class="el" href="classEmulateSnippet.html#a8143826681e065b6e04a38fb128188cb">getLoadImageValue()</a>, <a class="el" href="classAddrSpace.html#ab548f4158529a29122d4d0a30d94ed98">AddrSpace::getType()</a>, <a class="el" href="space_8hh.html#a1a83535cca68b7ca3f25bfad70262231a3ae8eb421cb8d460bc939657402d970a">IPTR_CONSTANT</a>, <a class="el" href="space_8hh.html#a1a83535cca68b7ca3f25bfad70262231a1eef2cfc279c246cc7ea0387d8c0aa66">IPTR_INTERNAL</a>, <a class="el" href="structVarnodeData.html#a1a511384ee72e847b51423cc99c8233e">VarnodeData::offset</a>, <a class="el" href="structVarnodeData.html#a50d39ae46d51c8854b962f3ec4ee4e25">VarnodeData::size</a>, <a class="el" href="structVarnodeData.html#a1a69a5187f7a6376c0c93c08962ea68d">VarnodeData::space</a>, and <a class="el" href="classEmulateSnippet.html#ab2f2e66401b029a1bd0f045328ff6fc5">tempValues</a>.</p>

<p class="reference">Referenced by <a class="el" href="classEmulateSnippet.html#af98797eb538d417acf1e2b06ccb63057">executeBinary()</a>, <a class="el" href="classEmulateSnippet.html#a6539d38f36a17f3bcf856a4a3b4d0895">executeCbranch()</a>, <a class="el" href="classEmulateSnippet.html#adecc94a311f6ed0c1f3de055354f16b3">executeLoad()</a>, and <a class="el" href="classEmulateSnippet.html#a8109743cbfc62e47a294d16926c825b1">executeUnary()</a>.</p>

</div>
</div>
<a id="a243812d9450f7d70610e23924def533f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a243812d9450f7d70610e23924def533f">&#9670;&nbsp;</a></span>resetMemory()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EmulateSnippet::resetMemory </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reset the emulation snippet. </p>
<p>Reset the memory state, and set the first p-code op as current. </p>

<p class="reference">References <a class="el" href="classEmulate.html#a8811816cbc0eef9f4cdb856cfd496e94">Emulate::emu_halted</a>, <a class="el" href="classEmulateSnippet.html#ace37ff31a80e1f296221195eeec4a4fb">setCurrentOp()</a>, and <a class="el" href="classEmulateSnippet.html#ab2f2e66401b029a1bd0f045328ff6fc5">tempValues</a>.</p>

<p class="reference">Referenced by <a class="el" href="classExecutablePcode.html#a0ff39a9bb778d67df86b741a20739d75">ExecutablePcode::evaluate()</a>.</p>

</div>
</div>
<a id="ace37ff31a80e1f296221195eeec4a4fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace37ff31a80e1f296221195eeec4a4fb">&#9670;&nbsp;</a></span>setCurrentOp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EmulateSnippet::setCurrentOp </td>
          <td>(</td>
          <td class="paramtype">int4&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the current executing p-code op by index. </p>
<p>The i-th p-code op in the snippet sequence is set as the currently executing op. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>is the index </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="classEmulate.html#a1e5d4f8c0ad5c62aa3e723440c5141ca">Emulate::currentBehave</a>, <a class="el" href="classEmulateSnippet.html#ace07c5e58e1c94197290cf0a2ee86f27">currentOp</a>, <a class="el" href="classPcodeOpRaw.html#ac790c26c33b84b492ce1146dfc813c8d">PcodeOpRaw::getBehavior()</a>, <a class="el" href="classEmulateSnippet.html#ad22c3300e30284d938e566b19af23f99">opList</a>, and <a class="el" href="classEmulateSnippet.html#a790341abc60fd2f7b36fa9d144a3c64f">pos</a>.</p>

<p class="reference">Referenced by <a class="el" href="classEmulateSnippet.html#a432015b441566c75b536685bd196f874">executeBranch()</a>, <a class="el" href="classEmulateSnippet.html#a6daea3b10d9b4830441835aa5263137b">fallthruOp()</a>, <a class="el" href="classEmulateSnippet.html#a243812d9450f7d70610e23924def533f">resetMemory()</a>, and <a class="el" href="classEmulateSnippet.html#a22a13101a25f73f33a9b10f20ebf018a">setExecuteAddress()</a>.</p>

</div>
</div>
<a id="abc4c1bf018f8ab3c0cea77fa927f5968"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc4c1bf018f8ab3c0cea77fa927f5968">&#9670;&nbsp;</a></span>setVarnodeValue()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EmulateSnippet::setVarnodeValue </td>
          <td>(</td>
          <td class="paramtype">uintb&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintb&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set a temporary register value in the machine state. </p>
<p>The temporary <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size.">Varnode</a>'s storage offset is used as key into the machine state map. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">offset</td><td>is the temporary storage offset </td></tr>
    <tr><td class="paramname">val</td><td>is the value to put into the machine state </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="classEmulateSnippet.html#ab2f2e66401b029a1bd0f045328ff6fc5">tempValues</a>.</p>

<p class="reference">Referenced by <a class="el" href="classExecutablePcode.html#a0ff39a9bb778d67df86b741a20739d75">ExecutablePcode::evaluate()</a>, <a class="el" href="classEmulateSnippet.html#af98797eb538d417acf1e2b06ccb63057">executeBinary()</a>, <a class="el" href="classEmulateSnippet.html#adecc94a311f6ed0c1f3de055354f16b3">executeLoad()</a>, and <a class="el" href="classEmulateSnippet.html#a8109743cbfc62e47a294d16926c825b1">executeUnary()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="emulateutil_8hh.html">emulateutil.hh</a></li>
<li>emulateutil.cc</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
