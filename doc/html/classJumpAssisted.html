<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>decompiler: JumpAssisted Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">decompiler
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classJumpAssisted-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">JumpAssisted Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A jump-table model assisted by pseudo-op directives in the code.  
 <a href="classJumpAssisted.html#details">More...</a></p>

<p><code>#include &lt;jumptable.hh&gt;</code></p>
<div class="dynheader">
Inheritance diagram for JumpAssisted:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classJumpAssisted.png" usemap="#JumpAssisted_map" alt=""/>
  <map id="JumpAssisted_map" name="JumpAssisted_map">
<area href="classJumpModel.html" title="A jump-table execution model." alt="JumpModel" shape="rect" coords="0,0,89,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1169f3856b15ba64fb229deec899a49b"><td class="memItemLeft" align="right" valign="top"><a id="a1169f3856b15ba64fb229deec899a49b"></a>
virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJumpAssisted.html#a1169f3856b15ba64fb229deec899a49b">isOverride</a> (void) const</td></tr>
<tr class="memdesc:a1169f3856b15ba64fb229deec899a49b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return <b>true</b> if <b>this</b> model was manually overridden. <br /></td></tr>
<tr class="separator:a1169f3856b15ba64fb229deec899a49b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d6285c9afd737070fe335b86d7592fa"><td class="memItemLeft" align="right" valign="top"><a id="a4d6285c9afd737070fe335b86d7592fa"></a>
virtual int4&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJumpAssisted.html#a4d6285c9afd737070fe335b86d7592fa">getTableSize</a> (void) const</td></tr>
<tr class="memdesc:a4d6285c9afd737070fe335b86d7592fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the number of entries in the address table. <br /></td></tr>
<tr class="separator:a4d6285c9afd737070fe335b86d7592fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54a3d21e91b75d420340cd403a53fc63"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJumpAssisted.html#a54a3d21e91b75d420340cd403a53fc63">recoverModel</a> (<a class="el" href="classFuncdata.html">Funcdata</a> *fd, <a class="el" href="classPcodeOp.html">PcodeOp</a> *indop, uint4 matchsize, uint4 maxtablesize)</td></tr>
<tr class="memdesc:a54a3d21e91b75d420340cd403a53fc63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempt to recover details of the model, given a specific BRANCHIND.  <a href="classJumpAssisted.html#a54a3d21e91b75d420340cd403a53fc63">More...</a><br /></td></tr>
<tr class="separator:a54a3d21e91b75d420340cd403a53fc63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff52f4a983f867d9bd105a6856e473a5"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJumpAssisted.html#aff52f4a983f867d9bd105a6856e473a5">buildAddresses</a> (<a class="el" href="classFuncdata.html">Funcdata</a> *fd, <a class="el" href="classPcodeOp.html">PcodeOp</a> *indop, vector&lt; <a class="el" href="classAddress.html">Address</a> &gt; &amp;addresstable, vector&lt; <a class="el" href="classLoadTable.html">LoadTable</a> &gt; *loadpoints) const</td></tr>
<tr class="memdesc:aff52f4a983f867d9bd105a6856e473a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct the explicit list of target addresses (the <a class="el" href="classAddress.html" title="A low-level machine address for labelling bytes and data.">Address</a> Table) from <b>this</b> model.  <a href="classJumpAssisted.html#aff52f4a983f867d9bd105a6856e473a5">More...</a><br /></td></tr>
<tr class="separator:aff52f4a983f867d9bd105a6856e473a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76bb3f116ab239f3b3f3fcf0410028d7"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJumpAssisted.html#a76bb3f116ab239f3b3f3fcf0410028d7">findUnnormalized</a> (uint4 maxaddsub, uint4 maxleftright, uint4 maxext)</td></tr>
<tr class="memdesc:a76bb3f116ab239f3b3f3fcf0410028d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recover the unnormalized switch variable.  <a href="classJumpAssisted.html#a76bb3f116ab239f3b3f3fcf0410028d7">More...</a><br /></td></tr>
<tr class="separator:a76bb3f116ab239f3b3f3fcf0410028d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8d0c353dd73697469c552b04146efe6"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJumpAssisted.html#aa8d0c353dd73697469c552b04146efe6">buildLabels</a> (<a class="el" href="classFuncdata.html">Funcdata</a> *fd, vector&lt; <a class="el" href="classAddress.html">Address</a> &gt; &amp;addresstable, vector&lt; uintb &gt; &amp;label, const <a class="el" href="classJumpModel.html">JumpModel</a> *orig) const</td></tr>
<tr class="memdesc:aa8d0c353dd73697469c552b04146efe6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recover <em>case</em> labels associated with the <a class="el" href="classAddress.html" title="A low-level machine address for labelling bytes and data.">Address</a> table.  <a href="classJumpAssisted.html#aa8d0c353dd73697469c552b04146efe6">More...</a><br /></td></tr>
<tr class="separator:aa8d0c353dd73697469c552b04146efe6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa36ee3e6e3749c41a43a3801579095eb"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classVarnode.html">Varnode</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJumpAssisted.html#aa36ee3e6e3749c41a43a3801579095eb">foldInNormalization</a> (<a class="el" href="classFuncdata.html">Funcdata</a> *fd, <a class="el" href="classPcodeOp.html">PcodeOp</a> *indop)</td></tr>
<tr class="memdesc:aa36ee3e6e3749c41a43a3801579095eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do normalization of the given switch specific to <b>this</b> model.  <a href="classJumpAssisted.html#aa36ee3e6e3749c41a43a3801579095eb">More...</a><br /></td></tr>
<tr class="separator:aa36ee3e6e3749c41a43a3801579095eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9162ab4e23d4d31e7b16e46a42442a98"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJumpAssisted.html#a9162ab4e23d4d31e7b16e46a42442a98">foldInGuards</a> (<a class="el" href="classFuncdata.html">Funcdata</a> *fd, <a class="el" href="classJumpTable.html">JumpTable</a> *jump)</td></tr>
<tr class="memdesc:a9162ab4e23d4d31e7b16e46a42442a98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Eliminate any <em>guard</em> code involved in computing the switch destination.  <a href="classJumpAssisted.html#a9162ab4e23d4d31e7b16e46a42442a98">More...</a><br /></td></tr>
<tr class="separator:a9162ab4e23d4d31e7b16e46a42442a98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acda2c7e13c4b78b8c229e63fad03374b"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJumpAssisted.html#acda2c7e13c4b78b8c229e63fad03374b">sanityCheck</a> (<a class="el" href="classFuncdata.html">Funcdata</a> *fd, <a class="el" href="classPcodeOp.html">PcodeOp</a> *indop, vector&lt; <a class="el" href="classAddress.html">Address</a> &gt; &amp;addresstable)</td></tr>
<tr class="memdesc:acda2c7e13c4b78b8c229e63fad03374b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a sanity check on recovered addresses.  <a href="classJumpAssisted.html#acda2c7e13c4b78b8c229e63fad03374b">More...</a><br /></td></tr>
<tr class="separator:acda2c7e13c4b78b8c229e63fad03374b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82f857a54f5ab3768f8682854a1ea8e3"><td class="memItemLeft" align="right" valign="top"><a id="a82f857a54f5ab3768f8682854a1ea8e3"></a>
virtual <a class="el" href="classJumpModel.html">JumpModel</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJumpAssisted.html#a82f857a54f5ab3768f8682854a1ea8e3">clone</a> (<a class="el" href="classJumpTable.html">JumpTable</a> *jt) const</td></tr>
<tr class="memdesc:a82f857a54f5ab3768f8682854a1ea8e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clone <b>this</b> model. <br /></td></tr>
<tr class="separator:a82f857a54f5ab3768f8682854a1ea8e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3173b13c73cc9c6b8d9451203b3dba0"><td class="memItemLeft" align="right" valign="top"><a id="ae3173b13c73cc9c6b8d9451203b3dba0"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><b>clear</b> (void)</td></tr>
<tr class="separator:ae3173b13c73cc9c6b8d9451203b3dba0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a78fdd1cd3ba9fd4cec74fa1e521204d1"><td class="memItemLeft" align="right" valign="top"><a id="a78fdd1cd3ba9fd4cec74fa1e521204d1"></a>
<a class="el" href="classPcodeOp.html">PcodeOp</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJumpAssisted.html#a78fdd1cd3ba9fd4cec74fa1e521204d1">assistOp</a></td></tr>
<tr class="memdesc:a78fdd1cd3ba9fd4cec74fa1e521204d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <em>jumpassist</em> <a class="el" href="classPcodeOp.html" title="Lowest level operation of the p-code language.">PcodeOp</a>. <br /></td></tr>
<tr class="separator:a78fdd1cd3ba9fd4cec74fa1e521204d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b92ae22e3de98346928d8cdad71e3ee"><td class="memItemLeft" align="right" valign="top"><a id="a1b92ae22e3de98346928d8cdad71e3ee"></a>
<a class="el" href="classJumpAssistOp.html">JumpAssistOp</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJumpAssisted.html#a1b92ae22e3de98346928d8cdad71e3ee">userop</a></td></tr>
<tr class="memdesc:a1b92ae22e3de98346928d8cdad71e3ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <em>jumpassist</em> p-code models. <br /></td></tr>
<tr class="separator:a1b92ae22e3de98346928d8cdad71e3ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c6a9e186cf0dde6564b87f6622b7ab0"><td class="memItemLeft" align="right" valign="top"><a id="a1c6a9e186cf0dde6564b87f6622b7ab0"></a>
int4&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJumpAssisted.html#a1c6a9e186cf0dde6564b87f6622b7ab0">sizeIndices</a></td></tr>
<tr class="memdesc:a1c6a9e186cf0dde6564b87f6622b7ab0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of indices in the table (not including the defaultaddress) <br /></td></tr>
<tr class="separator:a1c6a9e186cf0dde6564b87f6622b7ab0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1597b033112df649169b7921ff5258f9"><td class="memItemLeft" align="right" valign="top"><a id="a1597b033112df649169b7921ff5258f9"></a>
<a class="el" href="classVarnode.html">Varnode</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJumpAssisted.html#a1597b033112df649169b7921ff5258f9">switchvn</a></td></tr>
<tr class="memdesc:a1597b033112df649169b7921ff5258f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The switch variable. <br /></td></tr>
<tr class="separator:a1597b033112df649169b7921ff5258f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classJumpModel"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classJumpModel')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classJumpModel.html">JumpModel</a></td></tr>
<tr class="memitem:a3254101eed73a4e245587679682b510d inherit pro_attribs_classJumpModel"><td class="memItemLeft" align="right" valign="top"><a id="a3254101eed73a4e245587679682b510d"></a>
<a class="el" href="classJumpTable.html">JumpTable</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJumpModel.html#a3254101eed73a4e245587679682b510d">jumptable</a></td></tr>
<tr class="memdesc:a3254101eed73a4e245587679682b510d inherit pro_attribs_classJumpModel"><td class="mdescLeft">&#160;</td><td class="mdescRight">The jump-table that is building <b>this</b> model. <br /></td></tr>
<tr class="separator:a3254101eed73a4e245587679682b510d inherit pro_attribs_classJumpModel"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A jump-table model assisted by pseudo-op directives in the code. </p>
<p>This model looks for a special <em>jumpassist</em> pseudo-op near the branch site, which contains p-code models describing how to parse a jump-table for case labels and addresses. It views the switch table calculation as a two-stage process:</p><ul>
<li>case2index: convert the switchvar to an index into a table</li>
<li>index2address: convert the index to an address</li>
</ul>
<p>The pseudo-op holds:</p><ul>
<li>the table address, size (number of indices)</li>
<li>exemplar p-code for inverting the case2index part of the calculation</li>
<li>exemplar p-code for calculating index2address </li>
</ul>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="aff52f4a983f867d9bd105a6856e473a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff52f4a983f867d9bd105a6856e473a5">&#9670;&nbsp;</a></span>buildAddresses()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void JumpAssisted::buildAddresses </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classFuncdata.html">Funcdata</a> *&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPcodeOp.html">PcodeOp</a> *&#160;</td>
          <td class="paramname"><em>indop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; <a class="el" href="classAddress.html">Address</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>addresstable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; <a class="el" href="classLoadTable.html">LoadTable</a> &gt; *&#160;</td>
          <td class="paramname"><em>loadpoints</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Construct the explicit list of target addresses (the <a class="el" href="classAddress.html" title="A low-level machine address for labelling bytes and data.">Address</a> Table) from <b>this</b> model. </p>
<p>The addresses produced all come from the BRANCHIND and may not be deduped. Alternate guard destinations are not yet included. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>is the function containing the switch </td></tr>
    <tr><td class="paramname">indop</td><td>is the root BRANCHIND of the switch </td></tr>
    <tr><td class="paramname">addresstable</td><td>will hold the list of Addresses </td></tr>
    <tr><td class="paramname">loadpoints</td><td>if non-null will hold LOAD table information used by the model </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classJumpModel.html#a12659a93442cc2940a8fed8dc55be2e0">JumpModel</a>.</p>

<p class="reference">References <a class="el" href="classJumpAssisted.html#a78fdd1cd3ba9fd4cec74fa1e521204d1">assistOp</a>, <a class="el" href="classExecutablePcode.html#a0ff39a9bb778d67df86b741a20739d75">ExecutablePcode::evaluate()</a>, <a class="el" href="classJumpAssisted.html#a1c6a9e186cf0dde6564b87f6622b7ab0">sizeIndices</a>, and <a class="el" href="classJumpAssisted.html#a1b92ae22e3de98346928d8cdad71e3ee">userop</a>.</p>

</div>
</div>
<a id="aa8d0c353dd73697469c552b04146efe6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8d0c353dd73697469c552b04146efe6">&#9670;&nbsp;</a></span>buildLabels()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void JumpAssisted::buildLabels </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classFuncdata.html">Funcdata</a> *&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; <a class="el" href="classAddress.html">Address</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>addresstable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; uintb &gt; &amp;&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classJumpModel.html">JumpModel</a> *&#160;</td>
          <td class="paramname"><em>orig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Recover <em>case</em> labels associated with the <a class="el" href="classAddress.html" title="A low-level machine address for labelling bytes and data.">Address</a> table. </p>
<p>The unnormalized switch variable must already be recovered. Values that the normalized switch value can hold or walked back to obtain the value that the unnormalized switch variable would hold. Labels are returned in the order provided by normalized switch variable iterator <a class="el" href="classJumpValues.html" title="An iterator over values a switch variable can take.">JumpValues</a>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>is the function containing the switch </td></tr>
    <tr><td class="paramname">addresstable</td><td>is the address table (used to label code blocks with bad or missing labels) </td></tr>
    <tr><td class="paramname">label</td><td>will hold recovered labels in <a class="el" href="classJumpValues.html" title="An iterator over values a switch variable can take.">JumpValues</a> order </td></tr>
    <tr><td class="paramname">orig</td><td>is the <a class="el" href="classJumpModel.html" title="A jump-table execution model.">JumpModel</a> to use for the <a class="el" href="classJumpValues.html" title="An iterator over values a switch variable can take.">JumpValues</a> iterator </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classJumpModel.html#af8e7b936b4b51d87b7690693f756ffd6">JumpModel</a>.</p>

<p class="reference">References <a class="el" href="classJumpAssisted.html#a78fdd1cd3ba9fd4cec74fa1e521204d1">assistOp</a>, <a class="el" href="classExecutablePcode.html#a0ff39a9bb778d67df86b741a20739d75">ExecutablePcode::evaluate()</a>, <a class="el" href="classJumpAssisted.html#a1c6a9e186cf0dde6564b87f6622b7ab0">sizeIndices</a>, and <a class="el" href="classJumpAssisted.html#a1b92ae22e3de98346928d8cdad71e3ee">userop</a>.</p>

</div>
</div>
<a id="a76bb3f116ab239f3b3f3fcf0410028d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76bb3f116ab239f3b3f3fcf0410028d7">&#9670;&nbsp;</a></span>findUnnormalized()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void JumpAssisted::findUnnormalized </td>
          <td>(</td>
          <td class="paramtype">uint4&#160;</td>
          <td class="paramname"><em>maxaddsub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint4&#160;</td>
          <td class="paramname"><em>maxleftright</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint4&#160;</td>
          <td class="paramname"><em>maxext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Recover the unnormalized switch variable. </p>
<p>The normalized switch variable must already be recovered. The amount of normalization between the two switch variables can be restricted. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">maxaddsub</td><td>is a restriction on arithmetic operations </td></tr>
    <tr><td class="paramname">maxleftright</td><td>is a restriction on shift operations </td></tr>
    <tr><td class="paramname">maxext</td><td>is a restriction on extension operations </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classJumpModel.html#aac83f52fbf3ee566e760dfabe6e67ee6">JumpModel</a>.</p>

</div>
</div>
<a id="a9162ab4e23d4d31e7b16e46a42442a98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9162ab4e23d4d31e7b16e46a42442a98">&#9670;&nbsp;</a></span>foldInGuards()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool JumpAssisted::foldInGuards </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classFuncdata.html">Funcdata</a> *&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classJumpTable.html">JumpTable</a> *&#160;</td>
          <td class="paramname"><em>jump</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Eliminate any <em>guard</em> code involved in computing the switch destination. </p>
<p>We now think of the BRANCHIND as encompassing any guard function. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>is the function containing the switch </td></tr>
    <tr><td class="paramname">jump</td><td>is the <a class="el" href="classJumpTable.html" title="A map from values to control-flow targets within a function.">JumpTable</a> owning <b>this</b> model. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classJumpModel.html#a6f40ba77ddc8f4cf40f6071248103d9c">JumpModel</a>.</p>

<p class="reference">References <a class="el" href="classJumpTable.html#a02f58e3cb38a6bc41c0d7932370998be">JumpTable::setLastAsMostCommon()</a>.</p>

</div>
</div>
<a id="aa36ee3e6e3749c41a43a3801579095eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa36ee3e6e3749c41a43a3801579095eb">&#9670;&nbsp;</a></span>foldInNormalization()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classVarnode.html">Varnode</a> * JumpAssisted::foldInNormalization </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classFuncdata.html">Funcdata</a> *&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPcodeOp.html">PcodeOp</a> *&#160;</td>
          <td class="paramname"><em>indop</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Do normalization of the given switch specific to <b>this</b> model. </p>
<p>The <a class="el" href="classPcodeOp.html" title="Lowest level operation of the p-code language.">PcodeOp</a> machinery is removed so it looks like the CPUI_BRANCHIND simply takes the switch variable as an input <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size.">Varnode</a> and automatically interprets its values to reach the correct destination. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>is the function containing the switch </td></tr>
    <tr><td class="paramname">indop</td><td>is the given switch as a CPUI_BRANCHIND </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size.">Varnode</a> holding the final unnormalized switch variable </dd></dl>

<p>Implements <a class="el" href="classJumpModel.html#a7e8f2d4d8a1ae1954e00aae96c74a8c4">JumpModel</a>.</p>

<p class="reference">References <a class="el" href="classJumpAssisted.html#a78fdd1cd3ba9fd4cec74fa1e521204d1">assistOp</a>, <a class="el" href="classFuncdata.html#a6976625d7b40efca0bc9941cb199ee44">Funcdata::opDestroy()</a>, <a class="el" href="classFuncdata.html#aa079e2bd26e92671be79601535236a63">Funcdata::opSetInput()</a>, and <a class="el" href="classJumpAssisted.html#a1597b033112df649169b7921ff5258f9">switchvn</a>.</p>

</div>
</div>
<a id="a54a3d21e91b75d420340cd403a53fc63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54a3d21e91b75d420340cd403a53fc63">&#9670;&nbsp;</a></span>recoverModel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool JumpAssisted::recoverModel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classFuncdata.html">Funcdata</a> *&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPcodeOp.html">PcodeOp</a> *&#160;</td>
          <td class="paramname"><em>indop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint4&#160;</td>
          <td class="paramname"><em>matchsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint4&#160;</td>
          <td class="paramname"><em>maxtablesize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Attempt to recover details of the model, given a specific BRANCHIND. </p>
<p>This generally recovers the normalized switch variable and any guards. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>is the function containing the switch </td></tr>
    <tr><td class="paramname">indop</td><td>is the given BRANCHIND </td></tr>
    <tr><td class="paramname">matchsize</td><td>is the expected number of address table entries to recover, or 0 for no expectation </td></tr>
    <tr><td class="paramname">maxtablesize</td><td>is maximum number of address table entries to allow in the model </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><b>true</b> if details of the model were successfully recovered </dd></dl>

<p>Implements <a class="el" href="classJumpModel.html#a9c2326278dd18c9d78dd5cd5795e802b">JumpModel</a>.</p>

<p class="reference">References <a class="el" href="classJumpAssisted.html#a78fdd1cd3ba9fd4cec74fa1e521204d1">assistOp</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a7a2b625788b1d23eda50975b6baf7efb">CPUI_CALLOTHER</a>, <a class="el" href="classExecutablePcode.html#a0ff39a9bb778d67df86b741a20739d75">ExecutablePcode::evaluate()</a>, <a class="el" href="classJumpAssisted.html#a1c6a9e186cf0dde6564b87f6622b7ab0">sizeIndices</a>, <a class="el" href="classJumpAssisted.html#a1597b033112df649169b7921ff5258f9">switchvn</a>, and <a class="el" href="classJumpAssisted.html#a1b92ae22e3de98346928d8cdad71e3ee">userop</a>.</p>

</div>
</div>
<a id="acda2c7e13c4b78b8c229e63fad03374b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acda2c7e13c4b78b8c229e63fad03374b">&#9670;&nbsp;</a></span>sanityCheck()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool JumpAssisted::sanityCheck </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classFuncdata.html">Funcdata</a> *&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPcodeOp.html">PcodeOp</a> *&#160;</td>
          <td class="paramname"><em>indop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; <a class="el" href="classAddress.html">Address</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>addresstable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perform a sanity check on recovered addresses. </p>
<p>Individual addresses are checked against the function or its program to determine if they are reasonable. This method can optionally remove addresses from the table. If it does so, the underlying model is changed to reflect the removal. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>is the function containing the switch </td></tr>
    <tr><td class="paramname">indop</td><td>is the root BRANCHIND of the switch </td></tr>
    <tr><td class="paramname">addresstable</td><td>is the list of recovered Addresses, which may be modified </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><b>true</b> if there are (at least some) reasonable addresses in the table </dd></dl>

<p>Implements <a class="el" href="classJumpModel.html#a76a52bf3311e9d97a61d1117f6de1b0a">JumpModel</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="jumptable_8hh.html">jumptable.hh</a></li>
<li>jumptable.cc</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
