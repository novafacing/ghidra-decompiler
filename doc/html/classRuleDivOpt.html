<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>decompiler: RuleDivOpt Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">decompiler
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="classRuleDivOpt-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">RuleDivOpt Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Convert INT_MULT and shift forms into INT_DIV or INT_SDIV.  
 <a href="classRuleDivOpt.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for RuleDivOpt:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classRuleDivOpt.png" usemap="#RuleDivOpt_map" alt=""/>
  <map id="RuleDivOpt_map" name="RuleDivOpt_map">
<area href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode." alt="Rule" shape="rect" coords="0,0,76,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4fb0c5c3f7dec93f20d65f1919693802"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classRule.html">Rule</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRuleDivOpt.html#a4fb0c5c3f7dec93f20d65f1919693802">clone</a> (const <a class="el" href="classActionGroupList.html">ActionGroupList</a> &amp;grouplist) const</td></tr>
<tr class="memdesc:a4fb0c5c3f7dec93f20d65f1919693802"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clone the <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a>.  <a href="classRuleDivOpt.html#a4fb0c5c3f7dec93f20d65f1919693802">More...</a><br /></td></tr>
<tr class="separator:a4fb0c5c3f7dec93f20d65f1919693802"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adff3658edfa28c90464397a2e7c5b739"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRuleDivOpt.html#adff3658edfa28c90464397a2e7c5b739">getOpList</a> (vector&lt; uint4 &gt; &amp;oplist) const</td></tr>
<tr class="memdesc:adff3658edfa28c90464397a2e7c5b739"><td class="mdescLeft">&#160;</td><td class="mdescRight">List of op codes this rule operates on.  <a href="classRuleDivOpt.html#adff3658edfa28c90464397a2e7c5b739">More...</a><br /></td></tr>
<tr class="separator:adff3658edfa28c90464397a2e7c5b739"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8443133b32d917f3b751ba1fa7dee8f1"><td class="memItemLeft" align="right" valign="top">virtual int4&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRuleDivOpt.html#a8443133b32d917f3b751ba1fa7dee8f1">applyOp</a> (<a class="el" href="classPcodeOp.html">PcodeOp</a> *op, <a class="el" href="classFuncdata.html">Funcdata</a> &amp;data)</td></tr>
<tr class="memdesc:a8443133b32d917f3b751ba1fa7dee8f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempt to apply <b>this</b> <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a>.  <a href="classRuleDivOpt.html#a8443133b32d917f3b751ba1fa7dee8f1">More...</a><br /></td></tr>
<tr class="separator:a8443133b32d917f3b751ba1fa7dee8f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classRule"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classRule')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classRule.html">Rule</a></td></tr>
<tr class="memitem:af34899104f25035253a67d4d2665d0bf inherit pub_methods_classRule"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRule.html#af34899104f25035253a67d4d2665d0bf">Rule</a> (const string &amp;g, uint4 fl, const string &amp;nm)</td></tr>
<tr class="memdesc:af34899104f25035253a67d4d2665d0bf inherit pub_methods_classRule"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct given group, properties name.  <a href="classRule.html#af34899104f25035253a67d4d2665d0bf">More...</a><br /></td></tr>
<tr class="separator:af34899104f25035253a67d4d2665d0bf inherit pub_methods_classRule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bfe310fc05ec8dfb8d46953158d76f2 inherit pub_methods_classRule"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRule.html#a8bfe310fc05ec8dfb8d46953158d76f2">checkActionBreak</a> (void)</td></tr>
<tr class="memdesc:a8bfe310fc05ec8dfb8d46953158d76f2 inherit pub_methods_classRule"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if an action breakpoint is turned on.  <a href="classRule.html#a8bfe310fc05ec8dfb8d46953158d76f2">More...</a><br /></td></tr>
<tr class="separator:a8bfe310fc05ec8dfb8d46953158d76f2 inherit pub_methods_classRule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f074d593a6fefc79a5c07e4b3e13674 inherit pub_methods_classRule"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRule.html#a1f074d593a6fefc79a5c07e4b3e13674">reset</a> (<a class="el" href="classFuncdata.html">Funcdata</a> &amp;data)</td></tr>
<tr class="memdesc:a1f074d593a6fefc79a5c07e4b3e13674 inherit pub_methods_classRule"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset <b>this</b> <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a>.  <a href="classRule.html#a1f074d593a6fefc79a5c07e4b3e13674">More...</a><br /></td></tr>
<tr class="separator:a1f074d593a6fefc79a5c07e4b3e13674 inherit pub_methods_classRule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc634cc8f189a6641aac6e24e2473103 inherit pub_methods_classRule"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRule.html#adc634cc8f189a6641aac6e24e2473103">resetStats</a> (void)</td></tr>
<tr class="memdesc:adc634cc8f189a6641aac6e24e2473103 inherit pub_methods_classRule"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a> statistics.  <a href="classRule.html#adc634cc8f189a6641aac6e24e2473103">More...</a><br /></td></tr>
<tr class="separator:adc634cc8f189a6641aac6e24e2473103 inherit pub_methods_classRule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80e0ad50a132df1b33b7705ccdea01b3 inherit pub_methods_classRule"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRule.html#a80e0ad50a132df1b33b7705ccdea01b3">printStatistics</a> (ostream &amp;s) const</td></tr>
<tr class="memdesc:a80e0ad50a132df1b33b7705ccdea01b3 inherit pub_methods_classRule"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print statistics for <b>this</b> <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a>.  <a href="classRule.html#a80e0ad50a132df1b33b7705ccdea01b3">More...</a><br /></td></tr>
<tr class="separator:a80e0ad50a132df1b33b7705ccdea01b3 inherit pub_methods_classRule"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a07d4553e1000d607d3a49bd27d4425c3"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classVarnode.html">Varnode</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRuleDivOpt.html#a07d4553e1000d607d3a49bd27d4425c3">findForm</a> (<a class="el" href="classPcodeOp.html">PcodeOp</a> *op, int4 &amp;n, uintb &amp;y, int4 &amp;xsize, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7">OpCode</a> &amp;extopc)</td></tr>
<tr class="memdesc:a07d4553e1000d607d3a49bd27d4425c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for INT_(S)RIGHT and/or SUBPIECE followed by INT_MULT.  <a href="classRuleDivOpt.html#a07d4553e1000d607d3a49bd27d4425c3">More...</a><br /></td></tr>
<tr class="separator:a07d4553e1000d607d3a49bd27d4425c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a89d200fbd7cabb8961c44d4a4ad9b89e"><td class="memItemLeft" align="right" valign="top">static uintb&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRuleDivOpt.html#a89d200fbd7cabb8961c44d4a4ad9b89e">calcDivisor</a> (uintb n, uint8 y, int4 xsize)</td></tr>
<tr class="memdesc:a89d200fbd7cabb8961c44d4a4ad9b89e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the divisor.  <a href="classRuleDivOpt.html#a89d200fbd7cabb8961c44d4a4ad9b89e">More...</a><br /></td></tr>
<tr class="separator:a89d200fbd7cabb8961c44d4a4ad9b89e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad169dc0aa631077e01ffa0de7e1ce464"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRuleDivOpt.html#ad169dc0aa631077e01ffa0de7e1ce464">moveSignBitExtraction</a> (<a class="el" href="classVarnode.html">Varnode</a> *firstVn, <a class="el" href="classVarnode.html">Varnode</a> *replaceVn, <a class="el" href="classFuncdata.html">Funcdata</a> &amp;data)</td></tr>
<tr class="memdesc:ad169dc0aa631077e01ffa0de7e1ce464"><td class="mdescLeft">&#160;</td><td class="mdescRight">Replace sign-bit extractions from the first given <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size.">Varnode</a> with the second <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size.">Varnode</a>.  <a href="classRuleDivOpt.html#ad169dc0aa631077e01ffa0de7e1ce464">More...</a><br /></td></tr>
<tr class="separator:ad169dc0aa631077e01ffa0de7e1ce464"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_types_classRule"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classRule')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="classRule.html">Rule</a></td></tr>
<tr class="memitem:a605c4d4f6690f01deb9aa08c358fbc43 inherit pub_types_classRule"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRule.html#a605c4d4f6690f01deb9aa08c358fbc43">typeflags</a> { <a class="el" href="classRule.html#a605c4d4f6690f01deb9aa08c358fbc43abee2f75196ccb896f6288ba044adcf93">type_disable</a> = 1, 
<a class="el" href="classRule.html#a605c4d4f6690f01deb9aa08c358fbc43abe38bd9cfb49aea7e6cb1bf46a88ad20">rule_debug</a> = 2, 
<a class="el" href="classRule.html#a605c4d4f6690f01deb9aa08c358fbc43a42bedddab8f9d5f8fcfd165b0f8fb3e3">warnings_on</a> = 4, 
<a class="el" href="classRule.html#a605c4d4f6690f01deb9aa08c358fbc43a50c94d6ecacaf041c1b9dde93a4df022">warnings_given</a> = 8
 }</td></tr>
<tr class="memdesc:a605c4d4f6690f01deb9aa08c358fbc43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Properties associated with a <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a>.  <a href="classRule.html#a605c4d4f6690f01deb9aa08c358fbc43">More...</a><br /></td></tr>
<tr class="separator:a605c4d4f6690f01deb9aa08c358fbc43 inherit pub_types_classRule"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Convert INT_MULT and shift forms into INT_DIV or INT_SDIV. </p>
<p>The unsigned and signed variants are:</p><ul>
<li><code>sub( (zext(V)*c)&gt;&gt;n, 0) =&gt; V / (2^n/(c-1))</code></li>
<li><code>sub( (sext(V)*c)s&gt;&gt;n, 0) =&gt; V s/ (2^n/(c-1))</code> </li>
</ul>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a8443133b32d917f3b751ba1fa7dee8f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8443133b32d917f3b751ba1fa7dee8f1">&#9670;&nbsp;</a></span>applyOp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int4 RuleDivOpt::applyOp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPcodeOp.html">PcodeOp</a> *&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFuncdata.html">Funcdata</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Attempt to apply <b>this</b> <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a>. </p>
<p>This method contains the main logic for applying the <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a>. It must use a given <a class="el" href="classPcodeOp.html" title="Lowest level operation of the p-code language.">PcodeOp</a> as the point at which the <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a> applies. If it does apply, changes are made directly to the function and 1 (non-zero) is returned, otherwise 0 is returned. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">op</td><td>is the given <a class="el" href="classPcodeOp.html" title="Lowest level operation of the p-code language.">PcodeOp</a> where the <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a> may apply </td></tr>
    <tr><td class="paramname">data</td><td>is the function to which to apply </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classRule.html#a4e3e61f066670175009f60fb9dc60848">Rule</a>.</p>

<p class="reference">References <a class="el" href="classRuleDivOpt.html#a89d200fbd7cabb8961c44d4a4ad9b89e">calcDivisor()</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7ab13948fae3194faced3994780ca08061">CPUI_INT_ADD</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a38ec2a73a5be638f2b7c0e28753800c6">CPUI_INT_DIV</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a79114630f338eb1f7981f4dbac24cb60">CPUI_INT_SDIV</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a5fc7131a25cd3887d2ceabf181fa5b8a">CPUI_INT_SEXT</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7ac499e9c9aa80f99bb51ea4792e4a770a">CPUI_INT_SRIGHT</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a778868cfa2191f9621f632672e596702">CPUI_INT_ZEXT</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a2f366ca905ed81c22e500d5de37de366">CPUI_SUBPIECE</a>, <a class="el" href="classRuleDivOpt.html#a07d4553e1000d607d3a49bd27d4425c3">findForm()</a>, <a class="el" href="classRuleDivOpt.html#ad169dc0aa631077e01ffa0de7e1ce464">moveSignBitExtraction()</a>, <a class="el" href="classFuncdata.html#af58542dbcc89f4b84ffc8834b023125b">Funcdata::newConstant()</a>, <a class="el" href="classFuncdata.html#a1b1e9831bb4b1c65df6950ae1f15e0be">Funcdata::newOp()</a>, <a class="el" href="classFuncdata.html#af189a9a5b390332c6e87c8faa334cd68">Funcdata::newUniqueOut()</a>, <a class="el" href="classFuncdata.html#a9dd86e17a47020d06ac8dfd3bb732fe5">Funcdata::opInsertBefore()</a>, <a class="el" href="classFuncdata.html#aa079e2bd26e92671be79601535236a63">Funcdata::opSetInput()</a>, and <a class="el" href="classFuncdata.html#ad9dbf52668db4a1923537e2128719181">Funcdata::opSetOpcode()</a>.</p>

</div>
</div>
<a id="a89d200fbd7cabb8961c44d4a4ad9b89e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89d200fbd7cabb8961c44d4a4ad9b89e">&#9670;&nbsp;</a></span>calcDivisor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uintb RuleDivOpt::calcDivisor </td>
          <td>(</td>
          <td class="paramtype">uintb&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int4&#160;</td>
          <td class="paramname"><em>xsize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the divisor. </p>
<p>Given the multiplicative encoding <b>y</b> and the <b>n</b>, the power of 2, Compute: </p><div class="fragment"><div class="line">divisor = 2^n / (y-1)</div>
</div><!-- fragment --><p>Do some additional checks on the parameters as an optimized encoding of a divisor. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>is the power of 2 </td></tr>
    <tr><td class="paramname">y</td><td>is the multiplicative coefficient </td></tr>
    <tr><td class="paramname">xsize</td><td>is the maximum power of 2 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the divisor or 0 if the checks fail </dd></dl>

<p class="reference">References <a class="el" href="address_8hh.html#a09cc44c82138abf1b8fce558a3f0878d">power2Divide()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classRuleDivOpt.html#a8443133b32d917f3b751ba1fa7dee8f1">applyOp()</a>.</p>

</div>
</div>
<a id="a4fb0c5c3f7dec93f20d65f1919693802"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fb0c5c3f7dec93f20d65f1919693802">&#9670;&nbsp;</a></span>clone()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classRule.html">Rule</a>* RuleDivOpt::clone </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classActionGroupList.html">ActionGroupList</a> &amp;&#160;</td>
          <td class="paramname"><em>grouplist</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Clone the <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a>. </p>
<p>If <b>this</b> <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a> is a member of one of the groups in the grouplist, this returns a clone of the <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a>, otherwise NULL is returned. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">grouplist</td><td>is the list of groups being cloned </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the cloned <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a> or NULL </dd></dl>

<p>Implements <a class="el" href="classRule.html#a70de90a76461bfa7ea0b575ce3c11e4d">Rule</a>.</p>

<p class="reference">References <a class="el" href="classActionGroupList.html#a1da632f21f5671ecabc3c0551e787041">ActionGroupList::contains()</a>.</p>

</div>
</div>
<a id="a07d4553e1000d607d3a49bd27d4425c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07d4553e1000d607d3a49bd27d4425c3">&#9670;&nbsp;</a></span>findForm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classVarnode.html">Varnode</a> * RuleDivOpt::findForm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPcodeOp.html">PcodeOp</a> *&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int4 &amp;&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintb &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int4 &amp;&#160;</td>
          <td class="paramname"><em>xsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7">OpCode</a> &amp;&#160;</td>
          <td class="paramname"><em>extopc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check for INT_(S)RIGHT and/or SUBPIECE followed by INT_MULT. </p>
<p>Look for the forms:</p><ul>
<li><code>sub(ext(X) * #y,#c)</code> or</li>
<li><code>sub(ext(X) * #y,#c) &gt;&gt; n</code> or</li>
<li><code>(ext(X) * #y) &gt;&gt; n</code></li>
</ul>
<p>Looks for truncation/multiplication consistent with an optimized division. The truncation can come as either a SUBPIECE operation and/or right shifts. The numerand and the amount it has been extended is discovered. The extension can be, but doesn't have to be, an explicit INT_ZEXT or INT_SEXT. If the form doesn't match NULL is returned. If the <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size.">Varnode</a> holding the extended numerand matches the final operand size, it is returned, otherwise the unextended numerand is returned. The total truncation, the multiplicative constant, the numerand size, and the extension type are all passed back. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">op</td><td>is the root of the expression </td></tr>
    <tr><td class="paramname">n</td><td>is the reference that will hold the total number of bits of truncation </td></tr>
    <tr><td class="paramname">y</td><td>will hold the multiplicative constant </td></tr>
    <tr><td class="paramname">xsize</td><td>will hold the number of (non-zero) bits in the numerand </td></tr>
    <tr><td class="paramname">extopc</td><td>holds whether the extension is INT_ZEXT or INT_SEXT </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the extended numerand if possible, or the unextended numerand, or NULL </dd></dl>

<p class="reference">References <a class="el" href="address_8hh.html#a70e23e3408626b7fd45c1428774a245f">count_leading_zeros()</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7af4e88fc0408c2594dae2615b093aa68b">CPUI_INT_MULT</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7aaf220264eb8b109f50d4986eb6c5d3ca">CPUI_INT_RIGHT</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a5fc7131a25cd3887d2ceabf181fa5b8a">CPUI_INT_SEXT</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7ac499e9c9aa80f99bb51ea4792e4a770a">CPUI_INT_SRIGHT</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a778868cfa2191f9621f632672e596702">CPUI_INT_ZEXT</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a2541f47ee1b8f18543c5749b49cada91">CPUI_MAX</a>, and <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a2f366ca905ed81c22e500d5de37de366">CPUI_SUBPIECE</a>.</p>

<p class="reference">Referenced by <a class="el" href="classRuleDivOpt.html#a8443133b32d917f3b751ba1fa7dee8f1">applyOp()</a>.</p>

</div>
</div>
<a id="adff3658edfa28c90464397a2e7c5b739"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adff3658edfa28c90464397a2e7c5b739">&#9670;&nbsp;</a></span>getOpList()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void RuleDivOpt::getOpList </td>
          <td>(</td>
          <td class="paramtype">vector&lt; uint4 &gt; &amp;&#160;</td>
          <td class="paramname"><em>oplist</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>List of op codes this rule operates on. </p>
<p>Populate the given array with all possible OpCodes this <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a> might apply to. By default, this method returns all possible OpCodes </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">oplist</td><td>is the array to populate </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classRule.html#a4023bfc7825de0ab866790551856d10e">Rule</a>.</p>

<p class="reference">References <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7aaf220264eb8b109f50d4986eb6c5d3ca">CPUI_INT_RIGHT</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7ac499e9c9aa80f99bb51ea4792e4a770a">CPUI_INT_SRIGHT</a>, and <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a2f366ca905ed81c22e500d5de37de366">CPUI_SUBPIECE</a>.</p>

</div>
</div>
<a id="ad169dc0aa631077e01ffa0de7e1ce464"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad169dc0aa631077e01ffa0de7e1ce464">&#9670;&nbsp;</a></span>moveSignBitExtraction()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void RuleDivOpt::moveSignBitExtraction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classVarnode.html">Varnode</a> *&#160;</td>
          <td class="paramname"><em>firstVn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classVarnode.html">Varnode</a> *&#160;</td>
          <td class="paramname"><em>replaceVn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFuncdata.html">Funcdata</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Replace sign-bit extractions from the first given <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size.">Varnode</a> with the second <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size.">Varnode</a>. </p>
<p>Look for either:</p><ul>
<li><code>V &gt;&gt; 0x1f</code></li>
<li><code>V s&gt;&gt; 0x1f</code></li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">firstVn</td><td>is the first given <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size.">Varnode</a> </td></tr>
    <tr><td class="paramname">replaceVn</td><td>is the <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size.">Varnode</a> to replace it with in each extraction </td></tr>
    <tr><td class="paramname">data</td><td>is the function holding the Varnodes </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7aaf220264eb8b109f50d4986eb6c5d3ca">CPUI_INT_RIGHT</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7ac499e9c9aa80f99bb51ea4792e4a770a">CPUI_INT_SRIGHT</a>, and <a class="el" href="classFuncdata.html#aa079e2bd26e92671be79601535236a63">Funcdata::opSetInput()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classRuleDivOpt.html#a8443133b32d917f3b751ba1fa7dee8f1">applyOp()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="ruleaction_8hh.html">ruleaction.hh</a></li>
<li>ruleaction.cc</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
